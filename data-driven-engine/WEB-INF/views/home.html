<!--  
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
-->

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>data driven engine</title>

<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="http://code.interactjs.io/interact-1.2.4.min.js"></script>

<style>
.component-menu {
	width : 10%;
	height : 10%;
	min-height : 6.5em;
	margin : 0px;
	background-color : #29e;
	color : white;
	border-radius : 0.75em;
	padding : 4%;
	float : left;
}
.dragable{
	-webkit-transform : translate(0px, 0px);
	transform : translate(0px, 0px);
}

.dragable-not-drop{
	-webkit-transform : translate(0px, 0px);
	transform : translate(0px, 0px);
}
</style>

</head>
<body>

<div class="component-menu dragable">add component</div>
<div class="component-menu dragable-not-drop">add filter</div>
<canvas id="dataflow" width="578" height="200" style="background-color: blue">
</canvas>

<script type="text/javascript">
var controller;
var ui;
var data;

function Controller() {
	
}; //Controller
controller = new Controller();

function UI() {
	this.dragMoveListener = function(event){
		var target = event.target;
		x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
		y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
		
		target.style.webkitTransform = 
		target.style.transform = 
			'translate(' + x + 'px, ' + y + 'px)';
		
		target.setAttribute('data-x', x);
		target.setAttribute('data-y', y);
		
		ui.linedraw(0, 0, x, y);
	} //dragMoveListener
	
	this.moveToStartPointListener = function(event){
		var target = event.target;
		target.style.webkitTransform = 
		target.style.transform = 
			'translate(0px, 0px)';
		
		target.setAttribute('data-x', 0);
		target.setAttribute('data-y', 0);
	} //moveToStartPointListener
	
	this.applyDragDrop = function(querySelectorWord){
		interact(querySelectorWord).draggable({
			inertia : true,
			restrict : {
				restriction : 'parent',
				endOnly : true,
				elementRect : { top : 0, left : 0, bottom : 1, right : 1}
			},
			onmove : ui.dragMoveListener
		});
	} //applyDragDrop
	
	this.applyDragNotDrop = function(querySelectorWord){
		interact(querySelectorWord).draggable({
			inertia : true,
			restrict : {
				restriction : 'parent',
				endOnly : true,
				elementRect : { top : 0, left : 0, bottom : 1, right : 1}
			},
			onmove : ui.dragMoveListener,
			onend : ui.moveToStartPointListener
		});
	} //applyDragNotDrop
	
	this.linedraw = function(ax,ay,bx,by) {
	    if(ay>by)
	    {
	        bx=ax+bx;  
	        ax=bx-ax;
	        bx=bx-ax;
	        by=ay+by;  
	        ay=by-ay;  
	        by=by-ay;
	    }
	    var calc=Math.atan((ay-by)/(bx-ax));
	    calc=calc*180/Math.PI;
	    var length=Math.sqrt((ax-bx)*(ax-bx)+(ay-by)*(ay-by));
	    document.body.innerHTML += "<div id='line' style='height:" + length + "px;width:1px;background-color:black;position:absolute;top:" + (ay) + "px;left:" + (ax) + "px;transform:rotate(" + calc + "deg);-ms-transform:rotate(" + calc + "deg);transform-origin:0% 0%;-moz-transform:rotate(" + calc + "deg);-moz-transform-origin:0% 0%;-webkit-transform:rotate(" + calc  + "deg);-webkit-transform-origin:0% 0%;-o-transform:rotate(" + calc + "deg);-o-transform-origin:0% 0%;'></div>"
	}

}; //UI
ui = new UI();

function Data() {
	
}; //Data
data = new Data();

//INIT ----
ui.applyDragDrop('.dragable');
ui.applyDragNotDrop('.dragable-not-drop');

</script>
</body>
</html>